---
date: 2020-11-21
title: Chakra UI and Gatsby - Getting Started
tags: ['gatsby', 'getting started', 'guide']
private: true
---

Ok, so this is another one of those "let's use a new CSS-in-JS library
on a Gatsby default starter project" post.

In this case it's Chakra UI, it's recently gone v1 and I'm keen to use
it.

<Tweet tweetLink="thesegunadebayo/status/1327234974970425344" />

What I'm going to be doing is styling the [Gatsby starter default]
using Chakra UI and chucking in a theme toggle as well.

This will involve swapping out the styles that come with the [Gatsby
starter default] with Chakra UI ones.

The end result I'l aiming for is for it to look exactly the same as
before but using Chakra UI in place of the styling it comes with.

## Pre requisites

The usual notes on development environment, this comes with the
presumption you'll already have a development environment set up and
configured. If you don't have a development environment then you can
always use [CodeSandbox.io] to get up and running with an environment.

In the examples here I'm using Node version `14.13.0`.

Here's some of the dependencies being used in this guide, they're all
latest versions at the time of writing this.

```json
"@chakra-ui/gatsby-plugin": "^1.0.0",
"@chakra-ui/icons": "^1.0.1",
"@chakra-ui/react": "^1.0.1",
"@emotion/react": "^11.1.1",
"@emotion/styled": "^11.0.0",
"framer-motion": "^2.9.4",
"gatsby": "^2.26.1",
"react": "^17.0.1",
"react-dom": "^17.0.1",
```

## Create the thing

Spin up a new Gatsby project with `npx`:

```bash
npx gatsby new gatsby-chakra-ui
```

You can install and use the Gatsby CLI if you like, in this instance
I'm going `npx` as I'm not going to need any of the Gatsby CLI
functionality.

Wait for that to finish doing it's thing then change directory to the
freshly created gatsby project. Cool, cool, do a quick `yarn develop`
to make sure everything's installed ok with no issues.

## Install the things

```bash
yarn add \
  @chakra-ui/react \
  @emotion/react \
  @emotion/styled \
  framer-motion \
  @chakra-ui/gatsby-plugin \
  @chakra-ui/icons
```

Add the Chakra UI Gatsby plugin to the Gatsby plugin array in
`gatsby-config.js`, at the time of writing this plugin name was what's
recommended in the [Chakra UI documentation] and shouldn't be confused
with the [Gatsby documentation].

```js
plugins: [
  `@chakra-ui/gatsby-plugin`,
  // many more plugins ðŸ‘‡
```

All the styles are gone, that's the Gatsby plugin doing it's thing.

I'll remove the `import "./layout.css"` from the `layout.js`
component. I can then delete the `layout.css` file as it's not needed.

## Root Wrapper time!

So that I can access the Chakra UI Theme provider throughout the
project I'm going to add the `<ChakraProvider>` as [high up in the
React component tree] as possible.

I can do this by using the Gatsby `wrapPageElement` API in both the
`gatsby-browser.ja` and the `gatsby-ssr.js` files.

So I'm not to repeating the same code in both of those files I'm going
to create another file, add that in there and import that file into
both the `gatsby-browser.ja` and the `gatsby-ssr.js` files.

The name and location of this file is unimportant, keep it at the root
of the project with the `gatsby-browser.ja` and the `gatsby-ssr.js`
files or add it to the `src` folder, doesn't matter AFAIK.

Create the file, from my terminal I'll do a touch:

```bash
touch src/woot-wapper.tsx
```

In the root wrapper file I'll add the Chakra provider and the `Layout`
component.

```tsx
import { ChakraProvider } from '@chakra-ui/react'
import React from 'react'
import Layout from './components/layout'

export const wrapPageElement = ({ element }) => {
  return (
    <ChakraProvider resetCSS>
      <Layout>{element}</Layout>
    </ChakraProvider>
  )
}
```

So now there's no need to import the layout component into each page
that is created. I'll need to remove the layout from component from
the `404.js`, `index.js` and `page-2.js` pages.

## Theme Toggle

Using the Chakra UI theme provider means that I can use one of the
provided hooks to toggle the theme.

I'm going to create a theme toggle component:

```bash
touch src/components/toggle-theme.tsx
```

And add in some code to toggle the theme:

```tsx
import { MoonIcon, SunIcon } from '@chakra-ui/icons'
import {
  IconButton,
  useColorMode,
  useColorModeValue,
} from '@chakra-ui/react'
import React from 'react'

export default function ThemeToggle() {
  const { toggleColorMode: toggleMode } = useColorMode()
  const ToggleIcon = useColorModeValue(SunIcon, MoonIcon)

  return (
    <IconButton
      icon={<ToggleIcon />}
      variant="ghost"
      aria-label="Toggle Theme"
      onClick={toggleMode}
    />
  )
}
```

I'll add this to the header component

<!-- Links -->

[gatsby starter default]:
  https://github.com/gatsbyjs/gatsby-starter-default
[gatsby documentation]:
  https://www.gatsbyjs.com/plugins/gatsby-plugin-chakra-ui/
[chakra ui getting started]:
  https://chakra-ui.com/docs/getting-started
[codesandbox.io]: http://codesandbox.io/
[high up in the react component tree]:
  https://scottspence.com/2020/02/06/globally-style-gatsby-styled-components/#place-globalstyle-at-the-top-of-the-react-tree-
[chakra ui documentation]:
  https://github.com/chakra-ui/chakra-ui/blob/develop/website/pages/guides/integrations/with-gatsby.mdx#gatsby-plugin
